!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){return this._hasInvalidInput(this._inputEls)?this.disableButton():this.enableButton()}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this.disableButton(),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e){let{data:t,selector:s,handleCardClick:r,handleLikeClick:i,handleDeleteClick:n}=e;this._name=t.name,this._link=t.link,this._cardSelector=s,this._handleCardClick=r,this._likes=t.likes,this._cardId=t._id,this._userId=t.userId,this._ownerId=t.owner._id,this._handleLikeClick=i,this._handleDeleteClick=n}_setEventListeners(){this._element,this._likeButton.addEventListener("click",(()=>this._handleLikeClick(this))),this._element,this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._element,this._imageElement.addEventListener("click",(()=>this._handleCardClick({link:this._link,name:this._name})))}_handleLikeButton(){this.isLiked()?(this._element,this._likeButton.classList.add("cards__like-button_active")):(this._element,this._likeButton.classList.remove("cards__like-button_active"))}deleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}showLikes(e){this._likes=e||[],this._likeCounter.textContent=this._likes.length,this._handleLikeButton()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_removeDeleteButton(){this._userId!==this._ownerId&&this._deleteButton.remove()}getView(){return this._element=this._getTemplate(),this._imageElement=this._element.querySelector(".cards__image"),this._elementTitle=this._element.querySelector(".cards__location"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._elementTitle.textContent=this._name,this._likeButton=this._element.querySelector(".cards__like-button"),this._deleteButton=this._element.querySelector(".cards__delete"),this._likeCounter=this._element.querySelector(".cards__like-counter"),this.showLikes(this._likes),this._setEventListeners(),this._removeDeleteButton(),this._element}}const s=document.querySelector(".profile__edit-button"),r=document.querySelector("#add-button"),i=document.querySelector("#avatar-button"),n=document.querySelector(".modal__input_type_name"),o=document.querySelector(".modal__input_type_title"),a={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class l{constructor(e){let{modalSelector:t}=e;this._modal=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}openModal(){this._modal.classList.add("modal_open"),document.addEventListener("keyup",this._handleEscClose)}closeModal(){this._modal.classList.remove("modal_open"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){e.preventDefault(),"Escape"===e.key&&this.closeModal()}setEventListeners(){this._modal.addEventListener("mousedown",(e=>{e.target.closest(".modal__content")&&!e.target.classList.contains("modal__close-button")||this.closeModal()}))}}class d extends l{constructor(e){let{modalSelector:t,handleFormSubmit:s,resetOnClose:r}=e;super({modalSelector:t}),this._resetOnClose=r,this._modalForm=this._modal.querySelector(".modal__form"),this._inputList=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=s,this._submitButton=this._modal.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}closeModal(){this._resetOnClose&&this._modalForm.reset(),super.closeModal()}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}class h{constructor(e,t){let{items:s,renderer:r}=e;this._initialArray=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.append(e)}}const u=new class{constructor(e,t){this._baseUrl=e,this._headers=t}_handleServerResponse(e){if(e.ok)return e.json();Promise.reject(e.status)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleServerResponse)}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._handleServerResponse)}editUserInfo(e){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleServerResponse)}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleServerResponse)}postCard(e){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleServerResponse)}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._handleServerResponse)}showLikes(e){return fetch(`${this._baseUrl}/cards/likes${e}`,{headers:this.headers}).then(this._handleServerResponse)}addLikes(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._handleServerResponse)}removeLikes(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._handleServerResponse)}}("https://around.nomoreparties.co/v1/group-12",{authorization:"e3b84c1e-ff20-43fa-83a0-2b037664a87a","Content-Type":"application/json"});let c=null,_=null;const m=new class{constructor(e){let{userNameSelector:t,userTitleSelector:s,userAvatarSelector:r}=e;this._userName=document.querySelector(t),this._userTitle=document.querySelector(s),this._userAvatar=document.querySelector(r)}getUserInfo(){return{userName:this._userName.textContent,userTitle:this._userTitle.textContent,userAvatar:this._userAvatar.src}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._userName.textContent=t,this._userTitle.textContent=s,r&&(this._userAvatar.src=r)}}({userNameSelector:".profile__name",userTitleSelector:".profile__title",userAvatarSelector:".profile__image"});function v(e,s){const r=new t({data:{...e,userId:s},selector:"#card-template",handleCardClick:()=>{E.openModal(e)},handleLikeClick:e=>{r.isLiked()?u.removeLikes(e._cardId).then((e=>{r.showLikes(e.likes)})).catch((e=>{console.log(`An error has occured ${e}`)})):u.addLikes(e._cardId).then((e=>{r.showLikes(e.likes)})).catch((e=>{console.log(`An error has occured ${e}`)}))},handleDeleteClick:e=>{f.confirmDelete((()=>{f.setSubmitText(!0,"Deleting..."),u.deleteCard(e._cardId).then((()=>{e.deleteCard(),f.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>f.setSubmitText(!1)))})),f.openModal()}});return r.getView()}Promise.all([u.getUserInfo(),u.getInitialCards()]).then((e=>{let[t,s]=e;_=t._id,m.setUserInfo({name:t.name,about:t.about,avatar:t.avatar}),c=new h({items:s,renderer:e=>{c.addItem(v(e,_))}},".cards__array"),c.renderItems()})).catch((e=>{console.log(`An error has occured ${e}`)})),new e(a,document.querySelector("#edit-profile-form")).enableValidation();const p=new e(a,document.querySelector("#add-card-form"));p.enableValidation();const S=new e(a,document.querySelector("#avatar-form"));S.enableValidation();const b=new d({modalSelector:"#edit-modal",handleFormSubmit:e=>{b.setSubmitText(!0),u.editUserInfo(e).then((e=>{m.setUserInfo(e),b.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>b.setSubmitText(!1)))}});b.setEventListeners();const k=new d({modalSelector:"#add-modal",handleFormSubmit:e=>{k.setSubmitText(!0,"Creating..."),u.postCard(e).then((e=>{c.addItem(v(e,_)),k.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>k.setSubmitText(!1)))},resetOnClose:!0});k.setEventListeners();const C=new d({modalSelector:"#avatar-modal",handleFormSubmit:e=>{C.setSubmitText(!0),u.editAvatar(e).then((e=>{m.setUserInfo(e),C.closeModal()})).catch((e=>console.log(`An error has occured ${e}`))).finally((()=>C.setSubmitText(!1)))},resetOnClose:!0});C.setEventListeners();const E=new class extends l{constructor(e){super(e),this._modalCaption=this._modal.querySelector(".modal__preview-text"),this._modalImage=this._modal.querySelector(".modal__preview-image")}openModal(e){let{name:t,link:s}=e;this._modalCaption.textContent=t,this._modalImage.alt=t,this._modalImage.src=s,super.openModal()}}({modalSelector:"#preview-modal"});E.setEventListeners();const f=new class extends l{constructor(e){super(e),this._submitButton=this._modal.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._modalForm=this._modal.querySelector(".modal__form")}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}confirmDelete(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}({modalSelector:"#confirm-modal"});f.setEventListeners(),i.addEventListener("click",(()=>{S.resetValidation(),C.openModal()})),s.addEventListener("click",(()=>{const{userName:e,userTitle:t}=m.getUserInfo();n.value=e,o.value=t,p.resetValidation(),b.openModal()})),r.addEventListener("click",(()=>{p.resetValidation(),k.openModal()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L0J6SCxLQUFLa0MsY0FBY2YsWUFEakJxRyxFQUMrQkMsRUFFQXpILEtBQUtpSCxpQkFFMUMsQ0FFQXNFLGNBQWNZLEdBQ1puTSxLQUFLZ0gsa0JBQW9CbUYsQ0FDM0IsQ0FFQTlGLG9CQUNFTyxNQUFNUCxvQkFDTnJHLEtBQUs4RyxXQUFXdkUsaUJBQWlCLFVBQVdFLElBQzFDQSxFQUFNQyxpQkFDTjFDLEtBQUtnSCxtQkFBbUIsR0FFNUIsR0p5SmtELENBQUNuQixjSnJKckMsbUJJc0poQnlGLEVBQWtCakYsb0JBRWxCYixFQUFhakQsaUJBQWlCLFNBQVMsS0FDckNxSixFQUFvQnJLLGtCQUNwQndLLEVBQWU5RixXQUFXLElBRzVCWCxFQUFrQi9DLGlCQUFpQixTQUFTLEtBQzFDLE1BQU0sU0FBRW1JLEVBQVEsVUFBRUMsR0FBY1IsRUFBU2YsY0FDekMzRCxFQUFpQjRCLE1BQVFxRCxFQUN6QmhGLEVBQWtCMkIsTUFBUXNELEVBQzFCZ0IsRUFBaUJwSyxrQkFDakJzSyxFQUFpQjVGLFdBQVcsSUFHOUJWLEVBQWNoRCxpQkFBaUIsU0FBUyxLQUN0Q29KLEVBQWlCcEssa0JBQ2pCdUssRUFBYTdGLFdBQVcsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHt0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKX0pO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XG4gICAgICByZXR1cm4gdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmVuYWJsZUJ1dHRvbigpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gIWlucHV0TGlzdC5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2VDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2sgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IGRhdGEudXNlcklkO1xuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50O1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKSk7XG5cbiAgICB0aGlzLl9lbGVtZW50O1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xuXG4gICAgdGhpcy5fZWxlbWVudDtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSkpO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICB0aGlzLl9lbGVtZW50O1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZWxlbWVudDtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRzX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgc2hvd0xpa2VzKGRhdGEpIHtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEgfHwgW107XG4gICAgdGhpcy5fbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgoaXRlbSkgPT4gaXRlbS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBfcmVtb3ZlRGVsZXRlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIik7XG4gICAgdGhpcy5fZWxlbWVudFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19sb2NhdGlvblwiKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50VGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZGVsZXRlXCIpO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWNvdW50ZXJcIik7XG5cbiAgICB0aGlzLnNob3dMaWtlcyh0aGlzLl9saWtlcyk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9yZW1vdmVEZWxldGVCdXR0b24oKTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufSIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgY2FyZEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiKTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZExpc3RFbGVtZW50OiBcIi5jYXJkc19fYXJyYXlcIixcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gIHByZXZpZXdNb2RhbDogXCIjcHJldmlldy1tb2RhbFwiLFxuXG4gIHByb2ZpbGVFZGl0TW9kYWw6IFwiI2VkaXQtbW9kYWxcIixcbiAgY2FyZEFkZE1vZGFsOiBcIiNhZGQtbW9kYWxcIixcbiAgcHJvZmlsZU5hbWVFbGVtZW50OiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIHByb2ZpbGVUaXRsZUVsZW1lbnQ6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG5cbiAgYXZhdGFyTW9kYWxFbGVtZW50OiBcIiNhdmF0YXItbW9kYWxcIixcbiAgYXZhdGFyQnV0dG9uOiBcIiNhdmF0YXItYnV0dG9uXCIsXG4gIGF2YXRhckltYWdlOiBcIi5wcm9maWxlX19pbWFnZVwiLFxuXG4gIGNvbmZpcm1Nb2RhbDogXCIjY29uZmlybS1tb2RhbFwiLFxufTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCgpIHtcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2VNb2RhbCgpIHtcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlblwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICAhZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCIubW9kYWxfX2NvbnRlbnRcIikgfHxcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcih7IG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIHJlc2V0T25DbG9zZSB9KSB7XG4gICAgc3VwZXIoeyBtb2RhbFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3Jlc2V0T25DbG9zZSA9IHJlc2V0T25DbG9zZTtcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiAoZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIGlmICh0aGlzLl9yZXNldE9uQ2xvc2UpIHtcbiAgICAgIHRoaXMuX21vZGFsRm9ybS5yZXNldCgpO1xuICAgIH1cbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRTdWJtaXRUZXh0KHN1Ym1pdCwgc3VibWl0VGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoc3VibWl0KSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBzdWJtaXRUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCgoaXRlbSkgPT4ge3RoaXMuX3JlbmRlcmVyKGl0ZW0pfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG59IiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHtcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIGNhcmRBZGRCdXR0b24sXG4gIGF2YXRhckJ1dHRvbixcbiAgcHJvZmlsZU5hbWVJbnB1dCxcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgc2VsZWN0b3JzLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsV2l0aENvbmZpcm1hdGlvblwiO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgYXBpID0gbmV3IEFwaShcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIiwge1xuICBhdXRob3JpemF0aW9uOiBcImUzYjg0YzFlLWZmMjAtNDNmYS04M2EwLTJiMDM3NjY0YTg3YVwiLFxuICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbn0pO1xuXG5sZXQgY2FyZFNlY3Rpb24gPSBudWxsO1xubGV0IHVzZXJJZCA9IG51bGw7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWVTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZpbGVOYW1lRWxlbWVudCxcbiAgdXNlclRpdGxlU2VsZWN0b3I6IHNlbGVjdG9ycy5wcm9maWxlVGl0bGVFbGVtZW50LFxuICB1c2VyQXZhdGFyU2VsZWN0b3I6IHNlbGVjdG9ycy5hdmF0YXJJbWFnZSxcbn0pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbZGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlcklkID0gZGF0YS5faWQ7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxuICAgIH0pO1xuXG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShyZW5kZXJDYXJkKGNhcmREYXRhLCB1c2VySWQpKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3RvcnMuY2FyZExpc3RFbGVtZW50XG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFuIGVycm9yIGhhcyBvY2N1cmVkICR7ZXJyb3J9YCk7XG4gIH0pO1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhLCB1c2VySWQpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiB7IC4uLmNhcmREYXRhLCB1c2VySWQgfSxcbiAgICBzZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgaW1hZ2VNb2RhbC5vcGVuTW9kYWwoY2FyZERhdGEpO1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUNsaWNrOiAoZGF0YSkgPT4ge1xuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5yZW1vdmVMaWtlcyhkYXRhLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnNob3dMaWtlcyhyZXNwb25zZS5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5hZGRMaWtlcyhkYXRhLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnNob3dMaWtlcyhyZXNwb25zZS5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2s6IChjYXJkKSA9PiB7XG4gICAgICBjb25maXJtYXRpb25Nb2RhbC5jb25maXJtRGVsZXRlKCgpID0+IHtcbiAgICAgICAgY29uZmlybWF0aW9uTW9kYWwuc2V0U3VibWl0VGV4dCh0cnVlLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgICAgICBhcGlcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IGNvbmZpcm1hdGlvbk1vZGFsLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbiAgICAgIH0pO1xuICAgICAgY29uZmlybWF0aW9uTW9kYWwub3Blbk1vZGFsKCk7XG4gICAgfSxcbiAgfSk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIik7XG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtRWxlbWVudCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1mb3JtXCIpO1xuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYXZhdGFyRm9ybUVsZW1lbnQpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnQgTGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBzZWxlY3RvcnMucHJvZmlsZUVkaXRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBlZGl0UHJvZmlsZU1vZGFsLnNldFN1Ym1pdFRleHQodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZWRpdFVzZXJJbmZvKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBlZGl0UHJvZmlsZU1vZGFsLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbiAgfSxcbn0pO1xuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybSh7XG4gIG1vZGFsU2VsZWN0b3I6IHNlbGVjdG9ycy5jYXJkQWRkTW9kYWwsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChjYXJkRGF0YSkgPT4ge1xuICAgIG5ld0NhcmRNb2RhbC5zZXRTdWJtaXRUZXh0KHRydWUsIFwiQ3JlYXRpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAucG9zdENhcmQoY2FyZERhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoZGF0YSwgdXNlcklkKSk7XG4gICAgICAgIG5ld0NhcmRNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBuZXdDYXJkTW9kYWwuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9LFxuICByZXNldE9uQ2xvc2U6IHRydWUsXG59KTtcbm5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBuZXdBdmF0YXJNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3Rvcjogc2VsZWN0b3JzLmF2YXRhck1vZGFsRWxlbWVudCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBuZXdBdmF0YXJNb2RhbC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICAgIGFwaVxuICAgICAgLmVkaXRBdmF0YXIoZGF0YSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgICBuZXdBdmF0YXJNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYEFuIGVycm9yIGhhcyBvY2N1cmVkICR7ZXJyb3J9YCkpXG4gICAgICAuZmluYWxseSgoKSA9PiBuZXdBdmF0YXJNb2RhbC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG4gIH0sXG4gIHJlc2V0T25DbG9zZTogdHJ1ZSxcbn0pO1xubmV3QXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBNb2RhbFdpdGhJbWFnZSh7bW9kYWxTZWxlY3RvcjogXCIjcHJldmlldy1tb2RhbFwifSk7XG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNvbmZpcm1hdGlvbk1vZGFsID0gbmV3IE1vZGFsV2l0aENvbmZpcm1hdGlvbih7bW9kYWxTZWxlY3Rvcjogc2VsZWN0b3JzLmNvbmZpcm1Nb2RhbH0pO1xuY29uZmlybWF0aW9uTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIG5ld0F2YXRhck1vZGFsLm9wZW5Nb2RhbCgpO1xufSk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHsgdXNlck5hbWUsIHVzZXJUaXRsZSB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHVzZXJOYW1lO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJUaXRsZTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgZWRpdFByb2ZpbGVNb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jYXJkQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIG5ld0NhcmRNb2RhbC5vcGVuTW9kYWwoKTtcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGJhc2VVcmwsIGhlYWRlcnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVTZXJ2ZXJSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9IGVsc2UgUHJvbWlzZS5yZWplY3QocmVzcG9uc2Uuc3RhdHVzKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogZGF0YS5hYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICBwb3N0Q2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGNhcmRJZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIHNob3dMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICBhZGRMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZElkLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZXMoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmRJZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VyVGl0bGVTZWxlY3RvciwgdXNlckF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlclRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyVGl0bGVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VyTmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXG4gICAgICB1c2VyVGl0bGU6IHRoaXMuX3VzZXJUaXRsZS50ZXh0Q29udGVudCxcbiAgICAgIHVzZXJBdmF0YXI6IHRoaXMuX3VzZXJBdmF0YXIuc3JjXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3VzZXJUaXRsZS50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIGlmIChhdmF0YXIpIHtcbiAgICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgIH1cbiAgfVxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbiA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGV4dFwiKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gbGluaztcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcbiAgfVxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBjb25maXJtRGVsZXRlKGNvbmZpcm1hdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBjb25maXJtYXRpb247XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxzIiwiZm9yRWFjaCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZW5hYmxlQnV0dG9uIiwiaW5wdXRMaXN0IiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRJZCIsIl9pZCIsIl91c2VySWQiLCJ1c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9lbGVtZW50IiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2ltYWdlRWxlbWVudCIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiaXNMaWtlZCIsImRlbGV0ZUNhcmQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJzaG93TGlrZXMiLCJfbGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJzb21lIiwiaXRlbSIsIl9yZW1vdmVEZWxldGVCdXR0b24iLCJnZXRWaWV3IiwiX2VsZW1lbnRUaXRsZSIsInNyYyIsImFsdCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiY2FyZEFkZEJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlVGl0bGVJbnB1dCIsInZhbGlkYXRpb25TZXR0aW5ncyIsIk1vZGFsIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuTW9kYWwiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY2xvc2VzdCIsImNvbnRhaW5zIiwiTW9kYWxXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJyZXNldE9uQ2xvc2UiLCJzdXBlciIsIl9yZXNldE9uQ2xvc2UiLCJfbW9kYWxGb3JtIiwiX2lucHV0TGlzdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0U3VibWl0VGV4dCIsInN1Ym1pdCIsInN1Ym1pdFRleHQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2luaXRpYWxBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVNlcnZlclJlc3BvbnNlIiwicmVzcG9uc2UiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJlZGl0VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZWRpdEF2YXRhciIsImF2YXRhciIsInBvc3RDYXJkIiwiY2FyZElkIiwiYWRkTGlrZXMiLCJyZW1vdmVMaWtlcyIsImF1dGhvcml6YXRpb24iLCJjYXJkU2VjdGlvbiIsInVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJUaXRsZVNlbGVjdG9yIiwidXNlckF2YXRhclNlbGVjdG9yIiwiX3VzZXJOYW1lIiwiX3VzZXJUaXRsZSIsIl91c2VyQXZhdGFyIiwidXNlck5hbWUiLCJ1c2VyVGl0bGUiLCJ1c2VyQXZhdGFyIiwic2V0VXNlckluZm8iLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJjYXJkIiwiaW1hZ2VNb2RhbCIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiY29uZmlybWF0aW9uTW9kYWwiLCJjb25maXJtRGVsZXRlIiwiZmluYWxseSIsImFsbCIsImNhcmRzIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZU1vZGFsIiwibmV3Q2FyZE1vZGFsIiwibmV3QXZhdGFyTW9kYWwiLCJfbW9kYWxDYXB0aW9uIiwiX21vZGFsSW1hZ2UiLCJvcHRpb25zIiwiY29uZmlybWF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==