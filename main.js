!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){return this._hasInvalidInput(this._inputEls)?this.disableButton():this.enableButton()}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this.disableButton(),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e){let{data:t,selector:s,handleCardClick:r,handleLikeClick:i,handleDeleteClick:n}=e;this._name=t.name,this._link=t.link,this._cardSelector=s,this._handleCardClick=r,this._likes=t.likes,this._cardId=t._id,this._userId=t.userId,this._ownerId=t.owner._id,this._handleLikeClick=i,this._handleDeleteClick=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeClick(this))),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._imageElement.addEventListener("click",(()=>this._handleCardClick({link:this._link,name:this._name})))}_handleLikeButton(){this.isLiked()?this._likeButton.classList.add("cards__like-button_active"):this._likeButton.classList.remove("cards__like-button_active")}deleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}showLikes(e){this._likes=e||[],this._likeCounter.textContent=this._likes.length,this._handleLikeButton()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_removeDeleteButton(){this._userId!==this._ownerId&&this._deleteButton.remove()}getView(){return this._element=this._getTemplate(),this._imageElement=this._element.querySelector(".cards__image"),this._elementTitle=this._element.querySelector(".cards__location"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._elementTitle.textContent=this._name,this._likeButton=this._element.querySelector(".cards__like-button"),this._deleteButton=this._element.querySelector(".cards__delete"),this._likeCounter=this._element.querySelector(".cards__like-counter"),this.showLikes(this._likes),this._setEventListeners(),this._removeDeleteButton(),this._element}}const s=document.querySelector(".profile__edit-button"),r=document.querySelector("#add-button"),i=document.querySelector("#avatar-button"),n=document.querySelector(".modal__input_type_name"),o=document.querySelector(".modal__input_type_title"),a={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class l{constructor(e){let{modalSelector:t}=e;this._modal=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}openModal(){this._modal.classList.add("modal_open"),document.addEventListener("keyup",this._handleEscClose)}closeModal(){this._modal.classList.remove("modal_open"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){e.preventDefault(),"Escape"===e.key&&this.closeModal()}setEventListeners(){this._modal.addEventListener("mousedown",(e=>{e.target.closest(".modal__content")&&!e.target.classList.contains("modal__close-button")||this.closeModal()}))}}class d extends l{constructor(e){let{modalSelector:t,handleFormSubmit:s,resetOnClose:r}=e;super({modalSelector:t}),this._resetOnClose=r,this._modalForm=this._modal.querySelector(".modal__form"),this._inputList=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=s,this._submitButton=this._modal.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}closeModal(){this._resetOnClose&&this._modalForm.reset(),super.closeModal()}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}class h{constructor(e,t){let{items:s,renderer:r}=e;this._initialArray=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const u=new class{constructor(e,t){this._baseUrl=e,this._headers=t}_handleServerResponse(e){if(e.ok)return e.json();Promise.reject(e.status)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleServerResponse)}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._handleServerResponse)}editUserInfo(e){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleServerResponse)}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleServerResponse)}postCard(e){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleServerResponse)}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._handleServerResponse)}showLikes(e){return fetch(`${this._baseUrl}/cards/likes${e}`,{headers:this.headers}).then(this._handleServerResponse)}addLikes(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._handleServerResponse)}removeLikes(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._handleServerResponse)}}("https://around.nomoreparties.co/v1/group-12",{authorization:"e3b84c1e-ff20-43fa-83a0-2b037664a87a","Content-Type":"application/json"});let c=null,_=null;const m=new class{constructor(e){let{userNameSelector:t,userTitleSelector:s,userAvatarSelector:r}=e;this._userName=document.querySelector(t),this._userTitle=document.querySelector(s),this._userAvatar=document.querySelector(r)}getUserInfo(){return{userName:this._userName.textContent,userTitle:this._userTitle.textContent,userAvatar:this._userAvatar.src}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._userName.textContent=t,this._userTitle.textContent=s,r&&(this._userAvatar.src=r)}}({userNameSelector:".profile__name",userTitleSelector:".profile__title",userAvatarSelector:".profile__image"});function v(e,s){const r=new t({data:{...e,userId:s},selector:"#card-template",handleCardClick:()=>{E.openModal(e)},handleLikeClick:e=>{r.isLiked()?u.removeLikes(e._cardId).then((e=>{r.showLikes(e.likes)})).catch((e=>{console.log(`An error has occured ${e}`)})):u.addLikes(e._cardId).then((e=>{r.showLikes(e.likes)})).catch((e=>{console.log(`An error has occured ${e}`)}))},handleDeleteClick:e=>{f.confirmDelete((()=>{f.setSubmitText(!0,"Deleting..."),u.deleteCard(e._cardId).then((()=>{e.deleteCard(),f.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>f.setSubmitText(!1)))})),f.openModal()}});return r.getView()}Promise.all([u.getUserInfo(),u.getInitialCards()]).then((e=>{let[t,s]=e;_=t._id,m.setUserInfo({name:t.name,about:t.about,avatar:t.avatar}),c=new h({items:s,renderer:e=>{c.addItem(v(e,_))}},".cards__array"),c.renderItems()})).catch((e=>{console.log(`An error has occured ${e}`)})),new e(a,document.querySelector("#edit-profile-form")).enableValidation();const p=new e(a,document.querySelector("#add-card-form"));p.enableValidation();const S=new e(a,document.querySelector("#avatar-form"));S.enableValidation();const b=new d({modalSelector:"#edit-modal",handleFormSubmit:e=>{b.setSubmitText(!0),u.editUserInfo(e).then((e=>{m.setUserInfo(e),b.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>b.setSubmitText(!1)))}});b.setEventListeners();const k=new d({modalSelector:"#add-modal",handleFormSubmit:e=>{k.setSubmitText(!0,"Creating..."),u.postCard(e).then((e=>{c.addItem(v(e,_)),k.closeModal()})).catch((e=>{console.log(`An error has occured ${e}`)})).finally((()=>k.setSubmitText(!1)))},resetOnClose:!0});k.setEventListeners();const C=new d({modalSelector:"#avatar-modal",handleFormSubmit:e=>{C.setSubmitText(!0),u.editAvatar(e).then((e=>{m.setUserInfo(e),C.closeModal()})).catch((e=>console.log(`An error has occured ${e}`))).finally((()=>C.setSubmitText(!1)))},resetOnClose:!0});C.setEventListeners();const E=new class extends l{constructor(e){super(e),this._modalCaption=this._modal.querySelector(".modal__preview-text"),this._modalImage=this._modal.querySelector(".modal__preview-image")}openModal(e){let{name:t,link:s}=e;this._modalCaption.textContent=t,this._modalImage.alt=t,this._modalImage.src=s,super.openModal()}}({modalSelector:"#preview-modal"});E.setEventListeners();const f=new class extends l{constructor(e){super(e),this._submitButton=this._modal.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._modalForm=this._modal.querySelector(".modal__form")}setSubmitText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}confirmDelete(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}({modalSelector:"#confirm-modal"});f.setEventListeners(),i.addEventListener("click",(()=>{S.resetValidation(),C.openModal()})),s.addEventListener("click",(()=>{const{userName:e,userTitle:t}=m.getUserInfo();n.value=e,o.value=t,p.resetValidation(),b.openModal()})),r.addEventListener("click",(()=>{p.resetValidation(),k.openModal()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bk0sS0FBS2dILGtCQUFvQm1GLENBQzNCLENBRUE5RixvQkFDRU8sTUFBTVAsb0JBQ05yRyxLQUFLOEcsV0FBV3ZFLGlCQUFpQixVQUFXRSxJQUMxQ0EsRUFBTUMsaUJBQ04xQyxLQUFLZ0gsbUJBQW1CLEdBRTVCLEdKeUprRCxDQUFDbkIsY0pySnJDLG1CSXNKaEJ5RixFQUFrQmpGLG9CQUVsQmIsRUFBYWpELGlCQUFpQixTQUFTLEtBQ3JDcUosRUFBb0JySyxrQkFDcEJ3SyxFQUFlOUYsV0FBVyxJQUc1QlgsRUFBa0IvQyxpQkFBaUIsU0FBUyxLQUMxQyxNQUFNLFNBQUVtSSxFQUFRLFVBQUVDLEdBQWNSLEVBQVNmLGNBQ3pDM0QsRUFBaUI0QixNQUFRcUQsRUFDekJoRixFQUFrQjJCLE1BQVFzRCxFQUMxQmdCLEVBQWlCcEssa0JBQ2pCc0ssRUFBaUI1RixXQUFXLElBRzlCVixFQUFjaEQsaUJBQWlCLFNBQVMsS0FDdENvSixFQUFpQnBLLGtCQUNqQnVLLEVBQWE3RixXQUFXLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7dGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCl9KTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5lbmFibGVCdXR0b24oKTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuICFpbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCBzZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl91c2VySWQgPSBkYXRhLnVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpKTtcblxuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKSk7XG5cblxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZSB9KSk7XG4gIH1cblxuICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gIFxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBzaG93TGlrZXMoZGF0YSkge1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YSB8fCBbXTtcbiAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChpdGVtKSA9PiBpdGVtLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIF9yZW1vdmVEZWxldGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX3VzZXJJZCAhPT0gdGhpcy5fb3duZXJJZCkge1xuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICB0aGlzLl9lbGVtZW50VGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xvY2F0aW9uXCIpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2VsZW1lbnRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19kZWxldGVcIik7XG4gICAgdGhpcy5fbGlrZUNvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtY291bnRlclwiKTtcblxuICAgIHRoaXMuc2hvd0xpa2VzKHRoaXMuX2xpa2VzKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbW92ZURlbGV0ZUJ1dHRvbigpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59IiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhcmlhYmxlcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBjYXJkQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCIpO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkTGlzdEVsZW1lbnQ6IFwiLmNhcmRzX19hcnJheVwiLFxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgcHJldmlld01vZGFsOiBcIiNwcmV2aWV3LW1vZGFsXCIsXG5cbiAgcHJvZmlsZUVkaXRNb2RhbDogXCIjZWRpdC1tb2RhbFwiLFxuICBjYXJkQWRkTW9kYWw6IFwiI2FkZC1tb2RhbFwiLFxuICBwcm9maWxlTmFtZUVsZW1lbnQ6IFwiLnByb2ZpbGVfX25hbWVcIixcbiAgcHJvZmlsZVRpdGxlRWxlbWVudDogXCIucHJvZmlsZV9fdGl0bGVcIixcblxuICBhdmF0YXJNb2RhbEVsZW1lbnQ6IFwiI2F2YXRhci1tb2RhbFwiLFxuICBhdmF0YXJCdXR0b246IFwiI2F2YXRhci1idXR0b25cIixcbiAgYXZhdGFySW1hZ2U6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG5cbiAgY29uZmlybU1vZGFsOiBcIiNjb25maXJtLW1vZGFsXCIsXG59OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3Blbk1vZGFsKCkge1xuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgICFldmVudC50YXJnZXQuY2xvc2VzdChcIi5tb2RhbF9fY29udGVudFwiKSB8fFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWJ1dHRvblwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEZvcm0gZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgcmVzZXRPbkNsb3NlIH0pIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcmVzZXRPbkNsb3NlID0gcmVzZXRPbkNsb3NlO1xuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IChmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpKTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIGNsb3NlTW9kYWwoKSB7XG4gICAgaWYgKHRoaXMuX3Jlc2V0T25DbG9zZSkge1xuICAgICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XG4gICAgfVxuICAgIHN1cGVyLmNsb3NlTW9kYWwoKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldFN1Ym1pdFRleHQoc3VibWl0LCBzdWJtaXRUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChzdWJtaXQpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHN1Ym1pdFRleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5ID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7dGhpcy5fcmVuZGVyZXIoaXRlbSl9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59IiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHtcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIGNhcmRBZGRCdXR0b24sXG4gIGF2YXRhckJ1dHRvbixcbiAgcHJvZmlsZU5hbWVJbnB1dCxcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgc2VsZWN0b3JzLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsV2l0aENvbmZpcm1hdGlvblwiO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgYXBpID0gbmV3IEFwaShcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIiwge1xuICBhdXRob3JpemF0aW9uOiBcImUzYjg0YzFlLWZmMjAtNDNmYS04M2EwLTJiMDM3NjY0YTg3YVwiLFxuICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbn0pO1xuXG5sZXQgY2FyZFNlY3Rpb24gPSBudWxsO1xubGV0IHVzZXJJZCA9IG51bGw7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWVTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZpbGVOYW1lRWxlbWVudCxcbiAgdXNlclRpdGxlU2VsZWN0b3I6IHNlbGVjdG9ycy5wcm9maWxlVGl0bGVFbGVtZW50LFxuICB1c2VyQXZhdGFyU2VsZWN0b3I6IHNlbGVjdG9ycy5hdmF0YXJJbWFnZSxcbn0pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbZGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlcklkID0gZGF0YS5faWQ7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxuICAgIH0pO1xuXG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShyZW5kZXJDYXJkKGNhcmREYXRhLCB1c2VySWQpKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3RvcnMuY2FyZExpc3RFbGVtZW50XG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFuIGVycm9yIGhhcyBvY2N1cmVkICR7ZXJyb3J9YCk7XG4gIH0pO1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhLCB1c2VySWQpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiB7IC4uLmNhcmREYXRhLCB1c2VySWQgfSxcbiAgICBzZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgaW1hZ2VNb2RhbC5vcGVuTW9kYWwoY2FyZERhdGEpO1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUNsaWNrOiAoZGF0YSkgPT4ge1xuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5yZW1vdmVMaWtlcyhkYXRhLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnNob3dMaWtlcyhyZXNwb25zZS5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5hZGRMaWtlcyhkYXRhLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnNob3dMaWtlcyhyZXNwb25zZS5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2s6IChjYXJkKSA9PiB7XG4gICAgICBjb25maXJtYXRpb25Nb2RhbC5jb25maXJtRGVsZXRlKCgpID0+IHtcbiAgICAgICAgY29uZmlybWF0aW9uTW9kYWwuc2V0U3VibWl0VGV4dCh0cnVlLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgICAgICBhcGlcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkLl9jYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IGNvbmZpcm1hdGlvbk1vZGFsLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbiAgICAgIH0pO1xuICAgICAgY29uZmlybWF0aW9uTW9kYWwub3Blbk1vZGFsKCk7XG4gICAgfSxcbiAgfSk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIik7XG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtRWxlbWVudCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1mb3JtXCIpO1xuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYXZhdGFyRm9ybUVsZW1lbnQpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnQgTGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBzZWxlY3RvcnMucHJvZmlsZUVkaXRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBlZGl0UHJvZmlsZU1vZGFsLnNldFN1Ym1pdFRleHQodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZWRpdFVzZXJJbmZvKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBlZGl0UHJvZmlsZU1vZGFsLnNldFN1Ym1pdFRleHQoZmFsc2UpKTtcbiAgfSxcbn0pO1xuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybSh7XG4gIG1vZGFsU2VsZWN0b3I6IHNlbGVjdG9ycy5jYXJkQWRkTW9kYWwsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChjYXJkRGF0YSkgPT4ge1xuICAgIG5ld0NhcmRNb2RhbC5zZXRTdWJtaXRUZXh0KHRydWUsIFwiQ3JlYXRpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAucG9zdENhcmQoY2FyZERhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoZGF0YSwgdXNlcklkKSk7XG4gICAgICAgIG5ld0NhcmRNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgQW4gZXJyb3IgaGFzIG9jY3VyZWQgJHtlcnJvcn1gKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBuZXdDYXJkTW9kYWwuc2V0U3VibWl0VGV4dChmYWxzZSkpO1xuICB9LFxuICByZXNldE9uQ2xvc2U6IHRydWUsXG59KTtcbm5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBuZXdBdmF0YXJNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3Rvcjogc2VsZWN0b3JzLmF2YXRhck1vZGFsRWxlbWVudCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBuZXdBdmF0YXJNb2RhbC5zZXRTdWJtaXRUZXh0KHRydWUpO1xuICAgIGFwaVxuICAgICAgLmVkaXRBdmF0YXIoZGF0YSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgICBuZXdBdmF0YXJNb2RhbC5jbG9zZU1vZGFsKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYEFuIGVycm9yIGhhcyBvY2N1cmVkICR7ZXJyb3J9YCkpXG4gICAgICAuZmluYWxseSgoKSA9PiBuZXdBdmF0YXJNb2RhbC5zZXRTdWJtaXRUZXh0KGZhbHNlKSk7XG4gIH0sXG4gIHJlc2V0T25DbG9zZTogdHJ1ZSxcbn0pO1xubmV3QXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBNb2RhbFdpdGhJbWFnZSh7bW9kYWxTZWxlY3RvcjogXCIjcHJldmlldy1tb2RhbFwifSk7XG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNvbmZpcm1hdGlvbk1vZGFsID0gbmV3IE1vZGFsV2l0aENvbmZpcm1hdGlvbih7bW9kYWxTZWxlY3Rvcjogc2VsZWN0b3JzLmNvbmZpcm1Nb2RhbH0pO1xuY29uZmlybWF0aW9uTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIG5ld0F2YXRhck1vZGFsLm9wZW5Nb2RhbCgpO1xufSk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHsgdXNlck5hbWUsIHVzZXJUaXRsZSB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHVzZXJOYW1lO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJUaXRsZTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgZWRpdFByb2ZpbGVNb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jYXJkQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIG5ld0NhcmRNb2RhbC5vcGVuTW9kYWwoKTtcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGJhc2VVcmwsIGhlYWRlcnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVTZXJ2ZXJSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9IGVsc2UgUHJvbWlzZS5yZWplY3QocmVzcG9uc2Uuc3RhdHVzKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogZGF0YS5hYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICBwb3N0Q2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGNhcmRJZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIHNob3dMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICBhZGRMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZElkLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZXMoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmRJZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VyVGl0bGVTZWxlY3RvciwgdXNlckF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlclRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyVGl0bGVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VyTmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXG4gICAgICB1c2VyVGl0bGU6IHRoaXMuX3VzZXJUaXRsZS50ZXh0Q29udGVudCxcbiAgICAgIHVzZXJBdmF0YXI6IHRoaXMuX3VzZXJBdmF0YXIuc3JjXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3VzZXJUaXRsZS50ZXh0Q29udGVudCA9IGFib3V0O1xuICAgIGlmIChhdmF0YXIpIHtcbiAgICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgIH1cbiAgfVxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbiA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGV4dFwiKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gbGluaztcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcbiAgfVxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgc2V0U3VibWl0VGV4dChzdWJtaXQsIHN1Ym1pdFRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gc3VibWl0VGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBjb25maXJtRGVsZXRlKGNvbmZpcm1hdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBjb25maXJtYXRpb247XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxzIiwiZm9yRWFjaCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZW5hYmxlQnV0dG9uIiwiaW5wdXRMaXN0IiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRJZCIsIl9pZCIsIl91c2VySWQiLCJ1c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9pbWFnZUVsZW1lbnQiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsImlzTGlrZWQiLCJkZWxldGVDYXJkIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJzaG93TGlrZXMiLCJfbGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJzb21lIiwiaXRlbSIsIl9yZW1vdmVEZWxldGVCdXR0b24iLCJnZXRWaWV3IiwiX2VsZW1lbnRUaXRsZSIsInNyYyIsImFsdCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiY2FyZEFkZEJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlVGl0bGVJbnB1dCIsInZhbGlkYXRpb25TZXR0aW5ncyIsIk1vZGFsIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuTW9kYWwiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY2xvc2VzdCIsImNvbnRhaW5zIiwiTW9kYWxXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJyZXNldE9uQ2xvc2UiLCJzdXBlciIsIl9yZXNldE9uQ2xvc2UiLCJfbW9kYWxGb3JtIiwiX2lucHV0TGlzdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0U3VibWl0VGV4dCIsInN1Ym1pdCIsInN1Ym1pdFRleHQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2luaXRpYWxBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSIsInJlc3BvbnNlIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwiZWRpdFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImVkaXRBdmF0YXIiLCJhdmF0YXIiLCJwb3N0Q2FyZCIsImNhcmRJZCIsImFkZExpa2VzIiwicmVtb3ZlTGlrZXMiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyVGl0bGVTZWxlY3RvciIsInVzZXJBdmF0YXJTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VyVGl0bGUiLCJfdXNlckF2YXRhciIsInVzZXJOYW1lIiwidXNlclRpdGxlIiwidXNlckF2YXRhciIsInNldFVzZXJJbmZvIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwiY2FyZCIsImltYWdlTW9kYWwiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImNvbmZpcm1hdGlvbk1vZGFsIiwiY29uZmlybURlbGV0ZSIsImZpbmFsbHkiLCJhbGwiLCJjYXJkcyIsImFkZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiZWRpdFByb2ZpbGVNb2RhbCIsIm5ld0NhcmRNb2RhbCIsIm5ld0F2YXRhck1vZGFsIiwiX21vZGFsQ2FwdGlvbiIsIl9tb2RhbEltYWdlIiwib3B0aW9ucyIsImNvbmZpcm1hdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=